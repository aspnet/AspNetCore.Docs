<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Adding Validation </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Adding Validation ">
    <meta name="generator" content="docfx 2.24.0.0">
    
    <link rel="shortcut icon" href="../../favicon.ico">
    <link rel="stylesheet" href="../../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../../styles/docfx.css">
    <link rel="stylesheet" href="../../styles/main.css">
    <meta property="docfx:navrel" content="/foo">
    <meta property="docfx:tocrel" content="../../toc.html">
    
    
    
  </head>
  <body data-spy="scroll" data-target="#affix">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../../index.html">
                <img id="logo" class="svg" src="../../logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>
        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="tutorials/razor-pages/validation">
<h1 id="adding-validation-to-a-razor-page">Adding validation to a Razor Page</h1>

<p>By <a href="https://twitter.com/RickAndMSFT">Rick Anderson</a></p>
<p>In this section validation logic is added to the <code>Movie</code> model. The validation rules are enforced any time a user creates or edits a movie.</p>
<h2 id="validation">Validation</h2>
<p>A key tenet of software development is called <a href="https://wikipedia.org/wiki/Don%27t_repeat_yourself">DRY</a> (&quot;<strong>D</strong>on&#39;t <strong>R</strong>epeat <strong>Y</strong>ourself&quot;). Razor Pages encourages development where functionality is specified once, and it&#39;s reflected throughout the app. DRY can help reduce the amount of code in an app. DRY makes the code less error prone, and easier to test and maintain.</p>
<p>The validation support provided by Razor Pages and Entity Framework is a good example of the DRY principle. Validation rules are declaratively specified in one place (in the model class), and the rules are enforced everywhere in the app.</p>
<h3 id="adding-validation-rules-to-the-movie-model">Adding validation rules to the movie model</h3>
<p>Open the <em>Movie.cs</em> file. <a href="https://docs.microsoft.com/aspnet/mvc/overview/older-versions/mvc-music-store/mvc-music-store-part-6">DataAnnotations</a> provides a built-in set of validation attributes that are applied declaratively to a class or property. DataAnnotations also contains formatting attributes like <code>DataType</code> that help with formatting and don&#39;t provide validation.</p>
<p>Update the <code>Movie</code> class to take advantage of the <code>Required</code>, <code>StringLength</code>, <code>RegularExpression</code>, and <code>Range</code> validation attributes.</p>
<pre><code class="lang-csharp" name="Main">public class Movie
{
    public int ID { get; set; }

    [StringLength(60, MinimumLength = 3)]
    [Required]
    public string Title { get; set; }

    [Display(Name = &quot;Release Date&quot;)]
    [DataType(DataType.Date)]
    public DateTime ReleaseDate { get; set; }

    [Range(1, 100)]
    [DataType(DataType.Currency)]
    public decimal Price { get; set; }

    [RegularExpression(@&quot;^[A-Z]+[a-zA-Z&#39;&#39;-&#39;\s]*$&quot;)]
    [Required]
    [StringLength(30)]
    public string Genre { get; set; }

    [RegularExpression(@&quot;^[A-Z]+[a-zA-Z&#39;&#39;-&#39;\s]*$&quot;)]
    [StringLength(5)]
    [Required]
    public string Rating { get; set; }
}
</code></pre><p>Validation attributes specify behavior that is enforced on model properties. The <code>Required</code> and <code>MinimumLength</code> attributes indicates that a property must have a value; but nothing prevents a user from entering white space to satisfy the validation constraint. The <code>RegularExpression</code> attribute is used to limit what characters can be input. In the preceding code, <code>Genre</code> and <code>Rating</code> must use only letters (white space, numbers and special characters are not allowed). The <code>Range</code> attribute constrains a value to within a specified range. The <code>StringLength</code> attribute sets the maximum length of a string, and optionally the minimum length. <a href="https://docs.microsoft.com/dotnet/csharp/language-reference/keywords/value-types">Value types</a> (such as <code>decimal</code>, <code>int</code>, <code>float</code>, <code>DateTime</code>) are inherently required and don&#39;t need the <code>[Required]</code> attribute.</p>
<p>Having validation rules automatically enforced by ASP.NET Core helps make an app more robust. Automatic validation on models helps protect the app because you don&#39;t have to remember to apply them when new code is added.</p>
<h3 id="validation-error-ui-in-razor-pages">Validation Error UI in Razor Pages</h3>
<p>Run the app and navigate to Pages/Movies.</p>
<p>Select the <strong>Create New</strong> link. Complete the form with some invalid values. When jQuery client-side validation detects the error, it displays an error message.</p>
<p><img src="validation/_static/val.png" alt="Movie view form with multiple jQuery client-side validation errors"></p>
<div class="NOTE"><h5>Note</h5><p>You may not be able to enter decimal points or commas in the <code>Price</code> field. To support <a href="https://jqueryvalidation.org/">jQuery validation</a> in non-English locales that use a comma (&quot;,&quot;) for a decimal point, and non US-English date formats, you must take steps to globalize your app. See <a href="#additional-resources">Additional resources</a> for more information. For now, just enter whole numbers like 10.</p>
</div>
<p>Notice how the form has automatically rendered a validation error message in each field containing an invalid value. The errors are enforced both client-side (using JavaScript and jQuery) and server-side (when a user has JavaScript disabled).</p>
<p>A significant benefit is that <strong>no</strong> code changes were necessary in the Create  or Edit pages. Once DataAnnotations were applied to the model, the validation UI was enabled. The Razor Pages created in this tutorial automatically picked up the validation rules (using validation attributes on the properties of the <code>Movie</code> model class). Test validation using the Edit page, the same validation is applied.</p>
<p>The form data is not posted to the server until there are no client-side validation errors. Verify form data is not posted by one or more of the following approaches:</p>
<ul>
<li>Put a break point in the <code>OnPostAsync</code> method. Submit the form (select <strong>Create</strong> or <strong>Save</strong>). The break point is never hit.</li>
<li>Use the <a href="http://www.telerik.com/fiddler">Fiddler tool</a>.</li>
<li>Use the browser developer tools to monitor network traffic.</li>
</ul>
<h3 id="server-side-validation">Server-side validation</h3>
<p>When JavaScript is disabled in the browser, submitting the form with errors will post to the server.</p>
<p>Optional, test server-side validation:</p>
<ul>
<li>Disable JavaScript in the browser. If you can&#39;t disable JavaScript in the browser, try another browser.</li>
<li>Set a break point in the <code>OnPostAsync</code> method of the Create or Edit page.</li>
<li>Submit a form with validation errors.</li>
<li><p>Verify the model state is invalid:</p>
<pre><code class="lang-csharp"> if (!ModelState.IsValid)
 {
    return Page();
 }
</code></pre></li>
</ul>
<p>The following code shows a portion of the <em>Create.cshtml</em> page that you scaffolded earlier in the tutorial. It&#39;s used by the Create and Edit pages to display the initial form and to redisplay the form in the event of an error.</p>
<pre><code class="lang-cshtml" name="Main">&lt;form method=&quot;post&quot;&gt;
    &lt;div asp-validation-summary=&quot;ModelOnly&quot; class=&quot;text-danger&quot;&gt;&lt;/div&gt;
    &lt;div class=&quot;form-group&quot;&gt;
        &lt;label asp-for=&quot;Movie.Title&quot; class=&quot;control-label&quot;&gt;&lt;/label&gt;
        &lt;input asp-for=&quot;Movie.Title&quot; class=&quot;form-control&quot; /&gt;
        &lt;span asp-validation-for=&quot;Movie.Title&quot; class=&quot;text-danger&quot;&gt;&lt;/span&gt;
    &lt;/div&gt;
</code></pre><p>The <a class="xref" href="../../mvc/views/working-with-forms.html">Input Tag Helper</a> uses the <a href="https://docs.microsoft.com/aspnet/mvc/overview/older-versions/mvc-music-store/mvc-music-store-part-6">DataAnnotations</a> attributes and produces HTML attributes needed for jQuery Validation on the client-side. The <a class="xref" href="../../mvc/views/working-with-forms.html#the-validation-tag-helpers">Validation Tag Helper</a> displays validation errors. See <a class="xref" href="../../mvc/models/validation.html">Validation</a> for more information.</p>
<p>The Create and Edit pages have no validation rules in them. The validation rules and the error strings are specified only in the <code>Movie</code> class. These validation rules are automatically applied to Razor Pages that edit the <code>Movie</code> model.</p>
<p>When validation logic needs to change, it&#39;s done only in the model. Validation is applied consistently throughout the application (validation logic is defined in one place). Validation in one place helps keep the code clean, and makes it easier to maintain and update.</p>
<h2 id="using-datatype-attributes">Using DataType Attributes</h2>
<p>Examine the <code>Movie</code> class. The <code>System.ComponentModel.DataAnnotations</code> namespace provides formatting attributes in addition to the built-in set of validation attributes. The <code>DataType</code> attribute is applied to the <code>ReleaseDate</code> and <code>Price</code> properties.</p>
<pre><code class="lang-csharp" name="Main" highlight-lines="2,6">[Display(Name = &quot;Release Date&quot;)]
[DataType(DataType.Date)]
public DateTime ReleaseDate { get; set; }

[Range(1, 100)]
[DataType(DataType.Currency)]
public decimal Price { get; set; }
</code></pre><p>The <code>DataType</code> attributes only provide hints for the view engine to format the data (and supplies attributes such as <code>&lt;a&gt;</code> for URL&#39;s and <code>&lt;a href=&quot;mailto:EmailAddress.com&quot;&gt;</code> for email). Use the <code>RegularExpression</code> attribute to validate the format of the data. The <code>DataType</code> attribute is used to specify a data type that is more specific than the database intrinsic type. <code>DataType</code> attributes are not validation attributes. In the sample application, only the date is displayed, without time.</p>
<p>The <code>DataType</code> Enumeration provides for many data types, such as Date, Time, PhoneNumber, Currency, EmailAddress, and more. The <code>DataType</code> attribute can also enable the application to automatically provide type-specific features. For example, a <code>mailto:</code> link can be created for <code>DataType.EmailAddress</code>. A date selector can be provided for <code>DataType.Date</code> in browsers that support HTML5. The <code>DataType</code> attributes emits HTML 5 <code>data-</code> (pronounced data dash) attributes that HTML 5 browsers consume. The <code>DataType</code> attributes do <strong>not</strong> provide any validation.</p>
<p><code>DataType.Date</code> does not specify the format of the date that is displayed. By default, the data field is displayed according to the default formats based on the server&#39;s <code>CultureInfo</code>.</p>
<p>The <code>DisplayFormat</code> attribute is used to explicitly specify the date format:</p>
<pre><code class="lang-csharp">[DisplayFormat(DataFormatString = &quot;{0:yyyy-MM-dd}&quot;, ApplyFormatInEditMode = true)]
public DateTime ReleaseDate { get; set; }
</code></pre><p>The <code>ApplyFormatInEditMode</code> setting specifies that the formatting should be applied when the value is displayed for editing. You might not want that behavior for some fields. For example, in currency values, you probably do not want the currency symbol in the edit UI.</p>
<p>The <code>DisplayFormat</code> attribute can be used by itself, but it&#39;s generally a good idea to use the <code>DataType</code> attribute. The <code>DataType</code> attribute conveys the semantics of the data as opposed to how to render it on a screen, and provides the following benefits that you don&#39;t get with DisplayFormat:</p>
<ul>
<li>The browser can enable HTML5 features (for example to show a calendar control, the locale-appropriate currency symbol, email links, etc.)</li>
<li>By default, the browser will render data using the correct format based on your locale.</li>
<li>The <code>DataType</code> attribute can enable the ASP.NET Core framework to choose the right field template to render the data. The <code>DisplayFormat</code> if used by itself uses the string template.</li>
</ul>
<p>Note: jQuery validation does not work with the <code>Range</code> attribute and <code>DateTime</code>. For example, the following code will always display a client-side validation error, even when the date is in the specified range:</p>
<pre><code class="lang-csharp">[Range(typeof(DateTime), &quot;1/1/1966&quot;, &quot;1/1/2020&quot;)]
</code></pre><p>It&#39;s generally not a good practice to compile hard dates in your models, so using the <code>Range</code> attribute and <code>DateTime</code> is discouraged.</p>
<p>The following code shows combining attributes on one line:</p>
<pre><code class="lang-csharp" name="Main">public class Movie
{
    public int ID { get; set; }

    [StringLength(60, MinimumLength = 3)]
    public string Title { get; set; }

    [Display(Name = &quot;Release Date&quot;), DataType(DataType.Date)]
    public DateTime ReleaseDate { get; set; }

    [RegularExpression(@&quot;^[A-Z]+[a-zA-Z&#39;&#39;-&#39;\s]*$&quot;), Required, StringLength(30)]
    public string Genre { get; set; }

    [Range(1, 100), DataType(DataType.Currency)]
    public decimal Price { get; set; }

    [RegularExpression(@&quot;^[A-Z]+[a-zA-Z&#39;&#39;-&#39;\s]*$&quot;), StringLength(5)]
    public string Rating { get; set; }
}
</code></pre><h2 id="additional-resources">Additional resources</h2>
<ul>
<li><a class="xref" href="../../mvc/views/working-with-forms.html">Working with Forms</a></li>
<li><a class="xref" href="../../fundamentals/localization.html">Globalization and localization</a></li>
<li><a class="xref" href="../../mvc/views/tag-helpers/intro.html">Introduction to Tag Helpers</a></li>
<li><a class="xref" href="../../mvc/views/tag-helpers/authoring.html">Authoring Tag Helpers</a></li>
</ul>
<div class="step-by-step"><p><a class="xref" href="new-field.html">Previous: Adding a new field</a>
<a class="xref" href="uploading-files.html">Next: Uploading files</a></p>
</div>
</article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                  <li>
                    <a href="https://github.com/aspnet/Docs/blob/w/riande/RP-EF/aspnetcore/tutorials/razor-pages/validation.md/#L1" class="contribution-link">Improve this Doc</a>
                  </li>
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
              <!-- <p><a class="back-to-top" href="#top">Back to top</a><p> -->
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            
            <span>Copyright © 2015-2017 Microsoft<br>Generated by <strong>DocFX</strong></span>
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../../styles/docfx.js"></script>
    <script type="text/javascript" src="../../styles/main.js"></script>
  </body>
</html>
