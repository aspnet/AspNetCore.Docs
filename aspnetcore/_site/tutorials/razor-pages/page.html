<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Scaffolded Razor Pages in ASP.NET Core </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Scaffolded Razor Pages in ASP.NET Core ">
    <meta name="generator" content="docfx 2.24.0.0">
    
    <link rel="shortcut icon" href="../../favicon.ico">
    <link rel="stylesheet" href="../../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../../styles/docfx.css">
    <link rel="stylesheet" href="../../styles/main.css">
    <meta property="docfx:navrel" content="/foo">
    <meta property="docfx:tocrel" content="../../toc.html">
    
    
    
  </head>
  <body data-spy="scroll" data-target="#affix">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../../index.html">
                <img id="logo" class="svg" src="../../logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>
        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="tutorials/razor-pages/page">
<h1 id="scaffolded-razor-pages-in-aspnet-core">Scaffolded Razor Pages in ASP.NET Core</h1>

<p>By <a href="https://twitter.com/RickAndMSFT">Rick Anderson</a></p>
<p>This tutorial examines the Razor Pages created by scaffolding in the <a class="xref" href="page.html">previous tutorial</a>. </p>
<p><a href="https://github.com/aspnet/Docs/tree/master/aspnetcore/tutorials/razor-pages/razor-pages-start/sample/RazorPagesMovie">View or download</a> sample.</p>
<h2 id="the-create-delete-details-and-edit-pages">The Create, Delete, Details, and Edit pages.</h2>
<p>Examine the <em>Pages/Movies/Index.cshtml.cs</em> code-behind file:</p>
<pre><code class="lang-csharp" name="Main">using Microsoft.AspNetCore.Mvc.RazorPages;
using Microsoft.EntityFrameworkCore;
using System.Collections.Generic;
using System.Threading.Tasks;
using RazorPagesMovie.Models;


namespace RazorPagesMovie.Pages.Movies
{
    public class IndexModel : PageModel
    {
        private readonly RazorPagesMovie.Models.MovieContext _context;

        public IndexModel(RazorPagesMovie.Models.MovieContext context)
        {
            _context = context;
        }

        public IList&lt;Movie&gt; Movies { get;set; }

        public async Task OnGetAsync()
        {
            Movies = await _context.Movies.ToListAsync();
        }
    }
}
</code></pre><p>Razor Pages are derived from <code>PageModel</code>. By convention, the <code>PageModel</code>-derived class is called <code>&lt;PageName&gt;Model</code>. The constructor uses <a class="xref" href="../../fundamentals/dependency-injection.html">dependency injection</a> to add the <code>MovieContext</code> to the page. All the scaffolded pages follow this pattern.</p>
<p>When a request is made for the page, the <code>OnGetAsync</code> method returns a list of movies to the Razor Page. <code>OnGetAsync</code> or <code>OnGet</code> is called on a Razor Page to initialize the state for the page. In this case, <code>OnGetAsync</code> gets a list of movies to display.</p>
<p>Examine the <em>Pages/Movies/Index.cshtml</em> Razor Page:</p>
<pre><code class="lang-cshtml" name="Main">@page
@model RazorPagesMovie.Pages.Movies.IndexModel

@{
    ViewData[&quot;Title&quot;] = &quot;Index&quot;;
}

&lt;h2&gt;Index&lt;/h2&gt;

&lt;p&gt;
    &lt;a asp-page=&quot;Create&quot;&gt;Create New&lt;/a&gt;
&lt;/p&gt;
&lt;table class=&quot;table&quot;&gt;
    &lt;thead&gt;
        &lt;tr&gt;
            &lt;th&gt;
                @Html.DisplayNameFor(model =&gt; model.Movies[0].Title)
            &lt;/th&gt;
            &lt;th&gt;
                @Html.DisplayNameFor(model =&gt; model.Movies[0].ReleaseDate)
            &lt;/th&gt;
            &lt;th&gt;
                @Html.DisplayNameFor(model =&gt; model.Movies[0].Genre)
            &lt;/th&gt;
            &lt;th&gt;
                @Html.DisplayNameFor(model =&gt; model.Movies[0].Price)
            &lt;/th&gt;
            &lt;th&gt;&lt;/th&gt;
        &lt;/tr&gt;
    &lt;/thead&gt;
    &lt;tbody&gt;
@foreach (var item in Model.Movies) {
        &lt;tr&gt;
            &lt;td&gt;
                @Html.DisplayFor(modelItem =&gt; item.Title)
            &lt;/td&gt;
            &lt;td&gt;
                @Html.DisplayFor(modelItem =&gt; item.ReleaseDate)
            &lt;/td&gt;
            &lt;td&gt;
                @Html.DisplayFor(modelItem =&gt; item.Genre)
            &lt;/td&gt;
            &lt;td&gt;
                @Html.DisplayFor(modelItem =&gt; item.Price)
            &lt;/td&gt;
            &lt;td&gt;
                &lt;a asp-page=&quot;./Edit&quot; asp-route-id=&quot;@item.ID&quot;&gt;Edit&lt;/a&gt; |
                &lt;a asp-page=&quot;./Details&quot; asp-route-id=&quot;@item.ID&quot;&gt;Details&lt;/a&gt; |
                &lt;a asp-page=&quot;./Delete&quot; asp-route-id=&quot;@item.ID&quot;&gt;Delete&lt;/a&gt;
            &lt;/td&gt;
        &lt;/tr&gt;
}
    &lt;/tbody&gt;
&lt;/table&gt;
</code></pre><p>Razor can transition from HTML into C# or into Razor-specific markup. When an <code>@</code> symbol is followed by a <a class="xref" href="../../mvc/views/razor.html#razor-reserved-keywords">Razor reserved keyword</a>, it transitions into Razor-specific markup, otherwise it transitions into C#.</p>
<p>The <code>@page</code> Razor directive makes the file into an MVC action &mdash; which means that it can handle requests. <code>@page</code> must be the first Razor directive on a page. <code>@page</code> is an example of transitioning into Razor-specific markup. See <a class="xref" href="../../mvc/views/razor.html#razor-syntax">Razor syntax</a> for more information.</p>
<p>Examine the lambda expression used in the following HTML Helper:</p>
<pre><code class="lang-cshtml">@Html.DisplayNameFor(model =&gt; model.Movies[0].Title))
</code></pre><p>The <code>DisplayNameFor</code> HTML Helper inspects the <code>Title</code> property referenced in the lambda expression to determine the display name. The lambda expression is inspected rather than evaluated. That means there is no access violation when <code>model</code>, <code>model.Movies</code>, or <code>model.Movies[0]</code> are <code>null</code> or empty. When the lambda expression is evaluated (for example, with <code>@Html.DisplayFor(modelItem =&gt; item.Title)</code>), the model&#39;s property values are evaluated.</p>
<p><a name="md"></a></p>
<h3 id="the-model-directive">The @model directive</h3>
<pre><code class="lang-cshtml" name="Main" highlight-lines="2">@page
@model RazorPagesMovie.Pages.Movies.IndexModel
</code></pre><p>The <code>@model</code> directive specifies the type of the model passed to the Razor Page. In the preceding example, the <code>@model</code> line makes the <code>PageModel</code>-derived class available to the Razor Page. The model is used in the <code>@Html.DisplayNameFor</code> and <code>@Html.DisplayName</code> <a href="https://docs.microsoft.com/aspnet/mvc/overview/older-versions-1/views/creating-custom-html-helpers-cs#understanding-html-helpers">HTML Helpers</a> on the page.</p>
<!-- why don't xref links work?
[HTML Helpers 2](xref:aspnet/mvc/overview/older-versions-1/views/creating-custom-html-helpers-cs)
-->
<p><a name="vd"></a></p>
<h3 id="viewdata-and-layout">ViewData and layout</h3>
<p>Consider the following code:</p>
<pre><code class="lang-cshtml" name="Main" highlight-lines="4-">@page
@model RazorPagesMovie.Pages.Movies.IndexModel

@{
    ViewData[&quot;Title&quot;] = &quot;Index&quot;;
}
</code></pre><p>The preceding highlighted code is an example of Razor transitioning into C#. The <code>{</code> and <code>}</code> characters enclose a block of C# code.</p>
<p>The <code>PageModel</code> base class has a <code>ViewData</code> dictionary property that can be used to add data that you want to pass to a View. You add objects into the <code>ViewData</code> dictionary using a key/value pattern. In the preceding sample, the &quot;Title&quot; property is added to the <code>ViewData</code> dictionary. The &quot;Title&quot; property is used in the <em>Pages/_Layout.cshtml</em> file. The following markup shows the first few lines of the <em>Pages/_Layout.cshtml</em> file.</p>
<pre><code class="lang-cshtml" name="Main" highlight-lines="6-">&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;meta charset=&quot;utf-8&quot; /&gt;
    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot; /&gt;
    &lt;title&gt;@ViewData[&quot;Title&quot;] - RazorPagesMovie&lt;/title&gt;

    @*Markup removed for brevity.*@
</code></pre><p>The line <code>@*Markup removed for brevity.*@</code> is a Razor comment. Unlike HTML comments (<code>&lt;!-- --&gt;</code>), Razor comments are not sent to the client.</p>
<p>Run the app and test the links in the project (<strong>Home</strong>, <strong>About</strong>, <strong>Contact</strong>, <strong>Create</strong>, <strong>Edit</strong>, and <strong>Delete</strong>). Each page sets the title, which you can see in the browser tab. When you bookmark a page, the title is used for the bookmark. <em>Pages/Index.cshtml</em> and <em>Pages/Movies/Index.cshtml</em> currently have the same title, but you can modify them to have different values.</p>
<p>The <code>Layout</code> property is set in the <em>Pages/_ViewStart.cshtml</em> file:</p>
<pre><code class="lang-cshtml" name="Main">@{
    Layout = &quot;_Layout&quot;;
}
</code></pre><p>The preceding markup sets the layout file to <em>Pages/_Layout.cshtml</em> for all Razor files under the <em>Pages</em> folder. See <a class="xref" href="../../mvc/razor-pages/index.html#layout">Layout</a> for more information.</p>
<h3 id="update-the-layout">Update the layout</h3>
<p>Change the <code>&lt;title&gt;</code> element in the <em>Pages/_Layout.cshtml</em> file to use a shorter string.</p>
<pre><code class="lang-cshtml" name="Main" highlight-lines="6">&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;meta charset=&quot;utf-8&quot; /&gt;
    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot; /&gt;
    &lt;title&gt;@ViewData[&quot;Title&quot;] - Movie&lt;/title&gt;
</code></pre><p>Find the following anchor element in the <em>Pages/_Layout.cshtml</em> file.</p>
<pre><code class="lang-cshtml">&lt;a asp-page=&quot;/Index&quot; class=&quot;navbar-brand&quot;&gt;RazorPagesMovie&lt;/a&gt;
</code></pre><p>Replace the preceding element with the following markup.</p>
<pre><code class="lang-cshtml">&lt;a asp-page=&quot;/Movies/Index&quot; class=&quot;navbar-brand&quot;&gt;RpMovie&lt;/a&gt;
</code></pre><p>The preceding anchor element is a <a class="xref" href="../../mvc/views/tag-helpers/intro.html">Tag Helper</a>. In this case, it&#39;s the <a class="xref" href="../../mvc/views/tag-helpers/built-in/anchor-tag-helper.html">Anchor Tag Helper</a>. The <code>asp-page=&quot;/Movies/Index&quot;</code> Tag Helper attribute and value creates a link to the <code>/Movies/Index</code> Razor Page.</p>
<p>Save your changes, and test the app by clicking on the <strong>RpMovie</strong> link. See the <a href="https://github.com/aspnet/Docs/blob/master/aspnetcore/tutorials/razor-pages/razor-pages-start/sample/RazorPagesMovie/Pages/_Layout.cshtml">_Layout.cshtml</a> file in GitHub.</p>
<h3 id="the-create-code-behind-page">The Create code-behind page</h3>
<p>Examine the <em>Pages/Movies/Create.cshtml.cs</em> code-behind file:</p>
<pre><code class="lang-csharp" name="Main">// Unused usings removed.
using Microsoft.AspNetCore.Mvc;
using Microsoft.AspNetCore.Mvc.RazorPages;
using RazorPagesMovie.Models;
using System.Threading.Tasks;

namespace RazorPagesMovie.Pages.Movies
{
    public class CreateModel : PageModel
    {
        private readonly RazorPagesMovie.Models.MovieContext _context;

        public CreateModel(RazorPagesMovie.Models.MovieContext context)
        {
            _context = context;
        }

        public IActionResult OnGet()
        {
            return Page();
        }

        [BindProperty]
        public Movie Movie { get; set; }

        public async Task&lt;IActionResult&gt; OnPostAsync()
        {
            if (!ModelState.IsValid)
            {
                return Page();
            }

            _context.Movies.Add(Movie);
            await _context.SaveChangesAsync();

            return RedirectToPage(&quot;./Index&quot;);
        }
    }
}
</code></pre><p>The <code>OnGet</code> method initializes any state needed for the page. The Create page doesn&#39;t have any state to initialize. The <code>Page</code> method creates a <code>PageResult</code> object that renders the <em>Create.cshtml</em> page.</p>
<p>The <code>Movie</code> property uses the <code>[BindProperty]</code> attribute to opt-in to <a class="xref" href="../../mvc/models/model-binding.html">model binding</a>. When the Create form posts the form values, the ASP.NET Core runtime binds the posted values to the <code>Movie</code> model.</p>
<p>The <code>OnPostAsync</code> method is run when the page posts form data:</p>
<pre><code class="lang-csharp" name="Main">public async Task&lt;IActionResult&gt; OnPostAsync()
{
    if (!ModelState.IsValid)
    {
        return Page();
    }

    _context.Movies.Add(Movie);
    await _context.SaveChangesAsync();

    return RedirectToPage(&quot;./Index&quot;);
}
</code></pre><p>If there are any model errors, the form is redisplayed, along with any form data posted. Most model errors can be caught on the client-side before the form is posted. An example of a model error is posting a value for the date field that cannot be converted to a date. We&#39;ll talk more about client-side validation and model validation later in the tutorial.</p>
<p>If there are no model errors, the data is saved, and the browser is redirected to the Index page.</p>
<h3 id="the-create-razor-page">The Create Razor Page</h3>
<p>Examine the <em>Pages/Movies/Create.cshtml</em> Razor Page file:</p>
<pre><code class="lang-cshtml" name="Main">@page
@model RazorPagesMovie.Pages.Movies.CreateModel

@{
    ViewData[&quot;Title&quot;] = &quot;Create&quot;;
}

&lt;h2&gt;Create&lt;/h2&gt;

&lt;h4&gt;Movie&lt;/h4&gt;
&lt;hr /&gt;
&lt;div class=&quot;row&quot;&gt;
    &lt;div class=&quot;col-md-4&quot;&gt;
        &lt;form method=&quot;post&quot;&gt;
            &lt;div asp-validation-summary=&quot;ModelOnly&quot; class=&quot;text-danger&quot;&gt;&lt;/div&gt;
            &lt;div class=&quot;form-group&quot;&gt;
                &lt;label asp-for=&quot;Movie.Title&quot; class=&quot;control-label&quot;&gt;&lt;/label&gt;
                &lt;input asp-for=&quot;Movie.Title&quot; class=&quot;form-control&quot; /&gt;
                &lt;span asp-validation-for=&quot;Movie.Title&quot; class=&quot;text-danger&quot;&gt;&lt;/span&gt;
            &lt;/div&gt;
            &lt;div class=&quot;form-group&quot;&gt;
                &lt;label asp-for=&quot;Movie.ReleaseDate&quot; class=&quot;control-label&quot;&gt;&lt;/label&gt;
                &lt;input asp-for=&quot;Movie.ReleaseDate&quot; class=&quot;form-control&quot; /&gt;
                &lt;span asp-validation-for=&quot;Movie.ReleaseDate&quot; class=&quot;text-danger&quot;&gt;&lt;/span&gt;
            &lt;/div&gt;
            &lt;div class=&quot;form-group&quot;&gt;
                &lt;label asp-for=&quot;Movie.Genre&quot; class=&quot;control-label&quot;&gt;&lt;/label&gt;
                &lt;input asp-for=&quot;Movie.Genre&quot; class=&quot;form-control&quot; /&gt;
                &lt;span asp-validation-for=&quot;Movie.Genre&quot; class=&quot;text-danger&quot;&gt;&lt;/span&gt;
            &lt;/div&gt;
            &lt;div class=&quot;form-group&quot;&gt;
                &lt;label asp-for=&quot;Movie.Price&quot; class=&quot;control-label&quot;&gt;&lt;/label&gt;
                &lt;input asp-for=&quot;Movie.Price&quot; class=&quot;form-control&quot; /&gt;
                &lt;span asp-validation-for=&quot;Movie.Price&quot; class=&quot;text-danger&quot;&gt;&lt;/span&gt;
            &lt;/div&gt;
            &lt;div class=&quot;form-group&quot;&gt;
                &lt;input type=&quot;submit&quot; value=&quot;Create&quot; class=&quot;btn btn-default&quot; /&gt;
            &lt;/div&gt;
        &lt;/form&gt;
    &lt;/div&gt;
&lt;/div&gt;

&lt;div&gt;
    &lt;a asp-page=&quot;Index&quot;&gt;Back to List&lt;/a&gt;
&lt;/div&gt;

@section Scripts {
    @{await Html.RenderPartialAsync(&quot;_ValidationScriptsPartial&quot;);}
}
</code></pre><p>Visual Studio displays the <code>&lt;form method=&quot;post&quot;&gt;</code> tag in a distinctive font used for Tag Helpers. The <code>&lt;form method=&quot;post&quot;&gt;</code> element is a <a class="xref" href="../../mvc/views/working-with-forms.html#the-form-tag-helper">Form Tag Helper</a>. The Form Tag Helper automatically includes an <a class="xref" href="../../security/anti-request-forgery.html">antiforgery token</a>.</p>
<p><img src="page/_static/th.png" alt="VS17 view of Create.cshtml page"></p>
<p>The scaffolding engine creates Razor markup for each field in the model (except the ID) similar to the following:</p>
<pre><code class="lang-cshtml" name="Main">&lt;div asp-validation-summary=&quot;ModelOnly&quot; class=&quot;text-danger&quot;&gt;&lt;/div&gt;
&lt;div class=&quot;form-group&quot;&gt;
    &lt;label asp-for=&quot;Movie.Title&quot; class=&quot;control-label&quot;&gt;&lt;/label&gt;
    &lt;input asp-for=&quot;Movie.Title&quot; class=&quot;form-control&quot; /&gt;
    &lt;span asp-validation-for=&quot;Movie.Title&quot; class=&quot;text-danger&quot;&gt;&lt;/span&gt;
&lt;/div&gt;
</code></pre><p>The <a class="xref" href="../../mvc/views/working-with-forms.html#the-validation-tag-helpers">Validation Tag Helpers</a> (<code>&lt;div asp-validation-summary</code> and <code>&lt;span asp-validation-for</code>) display validation errors. Validation is covered in more detail later in this series.</p>
<p>The <a class="xref" href="../../mvc/views/working-with-forms.html#the-label-tag-helper">Label Tag Helper</a> (<code>&lt;label asp-for=&quot;Movie.Title&quot; class=&quot;control-label&quot;&gt;&lt;/label&gt;</code>) generates the label caption and <code>for</code> attribute for the <code>Title</code> property.</p>
<p>The <a class="xref" href="../../mvc/views/working-with-forms.html">Input Tag Helper</a> (<code>&lt;input asp-for=&quot;Movie.Title&quot; class=&quot;form-control&quot; /&gt;</code>) uses the <a href="https://docs.microsoft.com/aspnet/mvc/overview/older-versions/mvc-music-store/mvc-music-store-part-6">DataAnnotations</a> attributes and produces HTML attributes needed for jQuery Validation on the client-side.</p>
<p>The next tutorial explains SQL Server LocalDB and seeding the database.</p>
<div class="step-by-step"><p><a class="xref" href="model.html">Previous: Adding a model</a>
<a class="xref" href="sql.html">Next: SQL Server LocalDB</a></p>
</div>
</article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                  <li>
                    <a href="https://github.com/aspnet/Docs/blob/w/riande/RP-EF/aspnetcore/tutorials/razor-pages/page.md/#L1" class="contribution-link">Improve this Doc</a>
                  </li>
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
              <!-- <p><a class="back-to-top" href="#top">Back to top</a><p> -->
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            
            <span>Copyright © 2015-2017 Microsoft<br>Generated by <strong>DocFX</strong></span>
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../../styles/docfx.js"></script>
    <script type="text/javascript" src="../../styles/main.js"></script>
  </body>
</html>
